# ã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆ

## ç›®æ¬¡

- [æ¦‚è¦](#æ¦‚è¦)
- [ã‚¤ãƒ³ãƒ•ãƒ©å…¨ä½“æ§‹æˆå›³](#ã‚¤ãƒ³ãƒ•ãƒ©å…¨ä½“æ§‹æˆå›³)
- [ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ§‹æˆ](#ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ§‹æˆ)
  - [VPCè¨­è¨ˆ](#vpcè¨­è¨ˆ)
  - [ã‚µãƒ–ãƒãƒƒãƒˆæ§‹æˆ](#ã‚µãƒ–ãƒãƒƒãƒˆæ§‹æˆ)
  - [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—](#ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—)
  - [ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)
- [ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)
  - [ECS Fargateæ§‹æˆ](#ecs-fargateæ§‹æˆ)
  - [ã‚¿ã‚¹ã‚¯å®šç¾©](#ã‚¿ã‚¹ã‚¯å®šç¾©)
  - [ã‚µãƒ¼ãƒ“ã‚¹æ§‹æˆ](#ã‚µãƒ¼ãƒ“ã‚¹æ§‹æˆ)
  - [ã‚ªãƒ¼ãƒˆã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°](#ã‚ªãƒ¼ãƒˆã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°)
- [ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹](#ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹)
  - [RDS PostgreSQLæ§‹æˆ](#rds-postgresqlæ§‹æˆ)
  - [ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æˆ¦ç•¥](#ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æˆ¦ç•¥)
  - [ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³](#ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³)
- [ã‚­ãƒ£ãƒƒã‚·ãƒ¥](#ã‚­ãƒ£ãƒƒã‚·ãƒ¥)
  - [ElastiCache Redisæ§‹æˆ](#elasticache-redisæ§‹æˆ)
- [ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸](#ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸)
  - [S3ãƒã‚±ãƒƒãƒˆæ§‹æˆ](#s3ãƒã‚±ãƒƒãƒˆæ§‹æˆ)
  - [ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒãƒªã‚·ãƒ¼](#ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒãƒªã‚·ãƒ¼)
- [ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚·ãƒ³ã‚°](#ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚·ãƒ³ã‚°)
  - [ALBæ§‹æˆ](#albæ§‹æˆ)
  - [ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—](#ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—)
  - [ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯](#ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯)
- [CDN](#cdn)
  - [CloudFrontæ§‹æˆ](#cloudfrontæ§‹æˆ)
- [DNS](#dns)
  - [Route 53æ§‹æˆ](#route-53æ§‹æˆ)
- [ãƒ¡ãƒ¼ãƒ«é€ä¿¡](#ãƒ¡ãƒ¼ãƒ«é€ä¿¡)
  - [SESæ§‹æˆ](#sesæ§‹æˆ)
- [ç›£è¦–ãƒ»ãƒ­ã‚°](#ç›£è¦–ãƒ­ã‚°)
  - [CloudWatch](#cloudwatch)
  - [ãƒ­ã‚°ç®¡ç†](#ãƒ­ã‚°ç®¡ç†)
  - [ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š](#ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š)
- [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£](#ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£)
  - [IAM](#iam)
  - [Secrets Manager](#secrets-manager)
  - [WAF](#waf)
- [ç¤¾å†…ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶š](#ç¤¾å†…ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶š)
  - [VPNæ¥ç¶š](#vpnæ¥ç¶š)
  - [PrivateLink](#privatelink)
- [ç½å®³å¾©æ—§](#ç½å®³å¾©æ—§)
  - [ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æˆ¦ç•¥](#ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æˆ¦ç•¥-1)
  - [å¾©æ—§æ‰‹é †](#å¾©æ—§æ‰‹é †)
  - [RTO/RPO](#rtorpo)
- [ç’°å¢ƒæ§‹æˆ](#ç’°å¢ƒæ§‹æˆ)
  - [é–‹ç™ºç’°å¢ƒ](#é–‹ç™ºç’°å¢ƒ)
  - [ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒ](#ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒ)
  - [æœ¬ç•ªç’°å¢ƒ](#æœ¬ç•ªç’°å¢ƒ)
- [ã‚³ã‚¹ãƒˆè¦‹ç©ã‚‚ã‚Š](#ã‚³ã‚¹ãƒˆè¦‹ç©ã‚‚ã‚Š)
- [ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ](#ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ)
  - [CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³](#cicdãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³)
  - [Blue/Greenãƒ‡ãƒ—ãƒ­ã‚¤](#bluegreen ãƒ‡ãƒ—ãƒ­ã‚¤)
- [é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](#é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ)

## æ¦‚è¦

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€ç¤¾å†…è³‡ç”£ãƒ»å‚™å“ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£æ§‹æˆã‚’å®šç¾©ã—ã¾ã™ã€‚
AWSã®ãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ´»ç”¨ã—ã€é«˜å¯ç”¨æ€§ãƒ»æ‹¡å¼µæ€§ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’ç¢ºä¿ã—ãŸæ§‹æˆã¨ã—ã¾ã™ã€‚

## ã‚¤ãƒ³ãƒ•ãƒ©å…¨ä½“æ§‹æˆå›³

ä»¥ä¸‹ã®ã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆå›³ã¯Mermaidå½¢å¼ã§è¨˜è¿°ã•ã‚Œã¦ã„ã¾ã™ï¼ˆ[Mermaidå›³è¡¨è¨˜è¿°ãƒ«ãƒ¼ãƒ«](../00-rules/mermaid-diagram-rules.md)å‚ç…§ï¼‰ï¼š

```mermaid
graph TB
    %% ã‚¹ã‚¿ã‚¤ãƒ«å®šç¾©
    classDef publicSN fill:#dae8fc,stroke:#6c8ebf,stroke-width:2px,color:#000000
    classDef privateSN fill:#d5e8d4,stroke:#82b366,stroke-width:2px,color:#000000
    classDef dbSN fill:#fff2cc,stroke:#d6b656,stroke-width:2px,color:#000000
    classDef external fill:#f5f5f5,stroke:#666666,stroke-width:2px,color:#000000
    classDef storage fill:#e1d5e7,stroke:#9673a6,stroke-width:2px,color:#000000

    %% å¤–éƒ¨æ¥ç¶š
    Internet[ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆ<br/>ğŸ‘¥]:::external
    Corporate[ç¤¾å†…ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯<br/>ğŸ¢]:::external

    %% ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚µãƒ¼ãƒ“ã‚¹
    CloudFront[CloudFront CDN]:::external
    Route53[Route 53 DNS]:::external
    WAF[AWS WAF]:::external

    %% VPC
    subgraph VPC["AWS VPC (10.0.0.0/16)"]
        %% ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆ
        subgraph PublicSubnet["ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆ"]
            ALB[Application<br/>Load Balancer]:::publicSN
            NATGateway1[NAT Gateway<br/>AZ-1a]:::publicSN
            NATGateway2[NAT Gateway<br/>AZ-1c]:::publicSN
        end

        %% ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ–ãƒãƒƒãƒˆ
        subgraph PrivateAppSubnet["ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚¢ãƒ—ãƒªã‚µãƒ–ãƒãƒƒãƒˆ"]
            subgraph ECSCluster["ECS Fargate Cluster"]
                LaravelService[Laravel API<br/>Service<br/>2-8 tasks]:::privateSN
                NextjsService[Next.js Frontend<br/>Service<br/>2-8 tasks]:::privateSN
            end
        end

        %% ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µãƒ–ãƒãƒƒãƒˆ
        subgraph PrivateDBSubnet["ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆDBã‚µãƒ–ãƒãƒƒãƒˆ"]
            subgraph RDSCluster["RDS Multi-AZ"]
                RDSPrimary[(PostgreSQL<br/>Primary<br/>db.t4g.medium)]:::dbSN
                RDSStandby[(PostgreSQL<br/>Standby<br/>db.t4g.medium)]:::dbSN
            end

            subgraph ElastiCacheCluster["ElastiCache Multi-AZ"]
                CachePrimary[Redis<br/>Primary<br/>cache.t4g.small]:::dbSN
                CacheReplica[Redis<br/>Replica<br/>cache.t4g.small]:::dbSN
            end
        end
    end

    %% ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
    subgraph Storage["ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸"]
        S3Assets[S3<br/>è³‡ç”£ç”»åƒ/ãƒ•ã‚¡ã‚¤ãƒ«]:::storage
        S3Logs[S3<br/>ãƒ­ã‚°ãƒã‚±ãƒƒãƒˆ]:::storage
        ECR[ECR<br/>ã‚³ãƒ³ãƒ†ãƒŠãƒ¬ã‚¸ã‚¹ãƒˆãƒª]:::storage
    end

    %% ç®¡ç†ãƒ»ç›£è¦–
    subgraph Management["ç®¡ç†ãƒ»ç›£è¦–"]
        CloudWatch[CloudWatch<br/>ãƒ­ã‚°/ãƒ¡ãƒˆãƒªã‚¯ã‚¹]:::external
        SecretsManager[Secrets Manager<br/>èªè¨¼æƒ…å ±]:::external
        SES[Amazon SES<br/>ãƒ¡ãƒ¼ãƒ«é€ä¿¡]:::external
    end

    %% VPNæ¥ç¶š
    VPNGateway[VPN Gateway]:::external

    %% æ¥ç¶šãƒ•ãƒ­ãƒ¼
    Internet --> CloudFront
    CloudFront --> WAF
    WAF --> ALB
    Corporate --> VPNGateway
    VPNGateway --> VPC

    ALB --> LaravelService
    ALB --> NextjsService

    LaravelService --> RDSPrimary
    LaravelService --> CachePrimary
    LaravelService --> S3Assets
    LaravelService --> SES

    NextjsService --> LaravelService
    NextjsService --> S3Assets

    RDSPrimary -.åŒæœŸãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³.-> RDSStandby
    CachePrimary -.éåŒæœŸãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³.-> CacheReplica

    LaravelService --> NATGateway1
    NextjsService --> NATGateway2
    NATGateway1 --> Internet
    NATGateway2 --> Internet

    LaravelService --> SecretsManager
    LaravelService --> CloudWatch
    NextjsService --> CloudWatch

    LaravelService --> ECR
    NextjsService --> ECR

    S3Assets --> CloudFront
    ALB --> S3Logs
    CloudFront --> S3Logs

    %% DNSè§£æ±º
    Internet --> Route53
    Route53 --> CloudFront
```

**å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹**:
- Amazon SES (ãƒ¡ãƒ¼ãƒ«é€ä¿¡)
- CloudWatch (ç›£è¦–ãƒ»ãƒ­ã‚°)
- AWS Secrets Manager (èªè¨¼æƒ…å ±ç®¡ç†)
- AWS WAF (ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£)

## ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ§‹æˆ

### VPCè¨­è¨ˆ

**VPCä»•æ§˜**:

| é …ç›® | å€¤ |
|-----|-----|
| VPC CIDR | `10.0.0.0/16` |
| ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ | `ap-northeast-1` (æ±äº¬) |
| Availability Zone | `ap-northeast-1a`, `ap-northeast-1c` |
| DNSè§£æ±º | æœ‰åŠ¹ |
| DNSãƒ›ã‚¹ãƒˆå | æœ‰åŠ¹ |

**è¨­è¨ˆæ–¹é‡**:
- Multi-AZæ§‹æˆã§é«˜å¯ç”¨æ€§ã‚’ç¢ºä¿
- ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã§é‡è¦ãƒªã‚½ãƒ¼ã‚¹ã‚’ä¿è­·
- ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆã¯ALBã®ã¿é…ç½®

### ã‚µãƒ–ãƒãƒƒãƒˆæ§‹æˆ

| ã‚µãƒ–ãƒãƒƒãƒˆå | ã‚¿ã‚¤ãƒ— | CIDR | AZ | ç”¨é€” |
|------------|------|------|-----|------|
| public-subnet-1a | Public | `10.0.1.0/24` | 1a | ALB |
| public-subnet-1c | Public | `10.0.2.0/24` | 1c | ALB |
| private-app-subnet-1a | Private | `10.0.10.0/24` | 1a | ECS Fargate (App) |
| private-app-subnet-1c | Private | `10.0.11.0/24` | 1c | ECS Fargate (App) |
| private-db-subnet-1a | Private | `10.0.20.0/24` | 1a | RDS, ElastiCache |
| private-db-subnet-1c | Private | `10.0.21.0/24` | 1c | RDS, ElastiCache |

**ã‚µãƒ–ãƒãƒƒãƒˆè¨­è¨ˆã®ç†ç”±**:
- **Public Subnet**: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã¸ã®ãƒ«ãƒ¼ãƒˆã‚ã‚Šï¼ˆALBã®ã¿é…ç½®ï¼‰
- **Private App Subnet**: NATã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤çµŒç”±ã§ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚¢ã‚¯ã‚»ã‚¹ï¼ˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é…ç½®ï¼‰
- **Private DB Subnet**: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚¢ã‚¯ã‚»ã‚¹ä¸å¯ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é…ç½®ï¼‰

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—

#### ALBã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—

| ã‚¿ã‚¤ãƒ— | ãƒ—ãƒ­ãƒˆã‚³ãƒ« | ãƒãƒ¼ãƒˆ | ã‚½ãƒ¼ã‚¹ | èª¬æ˜ |
|-------|---------|-------|--------|------|
| Inbound | HTTPS | 443 | 0.0.0.0/0 | ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰HTTPS |
| Inbound | HTTP | 80 | 0.0.0.0/0 | HTTPã‹ã‚‰HTTPSã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ |
| Outbound | ã™ã¹ã¦ | ã™ã¹ã¦ | 0.0.0.0/0 | å…¨ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯è¨±å¯ |

#### ECS Fargateã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ— (Laravel)

| ã‚¿ã‚¤ãƒ— | ãƒ—ãƒ­ãƒˆã‚³ãƒ« | ãƒãƒ¼ãƒˆ | ã‚½ãƒ¼ã‚¹ | èª¬æ˜ |
|-------|---------|-------|--------|------|
| Inbound | HTTP | 8000 | ALB SG | ALBã‹ã‚‰ã®ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ |
| Outbound | PostgreSQL | 5432 | RDS SG | ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹ |
| Outbound | Redis | 6379 | ElastiCache SG | ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¢ã‚¯ã‚»ã‚¹ |
| Outbound | HTTPS | 443 | 0.0.0.0/0 | å¤–éƒ¨APIã‚¢ã‚¯ã‚»ã‚¹ |

#### ECS Fargateã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ— (Next.js)

| ã‚¿ã‚¤ãƒ— | ãƒ—ãƒ­ãƒˆã‚³ãƒ« | ãƒãƒ¼ãƒˆ | ã‚½ãƒ¼ã‚¹ | èª¬æ˜ |
|-------|---------|-------|--------|------|
| Inbound | HTTP | 3000 | ALB SG | ALBã‹ã‚‰ã®ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ |
| Outbound | HTTP | 8000 | Laravel SG | Laravel APIã‚¢ã‚¯ã‚»ã‚¹ |
| Outbound | HTTPS | 443 | 0.0.0.0/0 | å¤–éƒ¨ãƒªã‚½ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹ |

#### RDSã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—

| ã‚¿ã‚¤ãƒ— | ãƒ—ãƒ­ãƒˆã‚³ãƒ« | ãƒãƒ¼ãƒˆ | ã‚½ãƒ¼ã‚¹ | èª¬æ˜ |
|-------|---------|-------|--------|------|
| Inbound | PostgreSQL | 5432 | ECS SG (Laravel) | Laravelã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ |
| Inbound | PostgreSQL | 5432 | ç¤¾å†…VPN | é‹ç”¨ãƒ»ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ç”¨ |

#### ElastiCacheã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—

| ã‚¿ã‚¤ãƒ— | ãƒ—ãƒ­ãƒˆã‚³ãƒ« | ãƒãƒ¼ãƒˆ | ã‚½ãƒ¼ã‚¹ | èª¬æ˜ |
|-------|---------|-------|--------|------|
| Inbound | Redis | 6379 | ECS SG (Laravel) | Laravelã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ |

### ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

#### ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«

| å®›å…ˆ | ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ |
|-----|----------|
| 10.0.0.0/16 | local |
| 0.0.0.0/0 | Internet Gateway |

#### ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚¢ãƒ—ãƒªã‚µãƒ–ãƒãƒƒãƒˆãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«

| å®›å…ˆ | ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ |
|-----|----------|
| 10.0.0.0/16 | local |
| 0.0.0.0/0 | NAT Gateway |

#### ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆDBã‚µãƒ–ãƒãƒƒãƒˆãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«

| å®›å…ˆ | ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ |
|-----|----------|
| 10.0.0.0/16 | local |

**NAT Gateway**:
- å„AZã«1ã¤ãšã¤é…ç½®ï¼ˆé«˜å¯ç”¨æ€§ï¼‰
- Elastic IPå‰²ã‚Šå½“ã¦
- ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã‹ã‚‰ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚¢ã‚¯ã‚»ã‚¹ã‚’æä¾›

## ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ECS Fargateæ§‹æˆ

**ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ä»•æ§˜**:

| é …ç›® | å€¤ |
|-----|-----|
| ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼å | `asset-management-cluster` |
| èµ·å‹•ã‚¿ã‚¤ãƒ— | Fargate |
| ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ | awsvpc |

**Fargateã®åˆ©ç‚¹**:
- ã‚µãƒ¼ãƒãƒ¼ç®¡ç†ä¸è¦
- ã‚ªãƒ¼ãƒˆã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ãŒå®¹æ˜“
- ã‚³ãƒ³ãƒ†ãƒŠå˜ä½ã§èª²é‡‘
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ‘ãƒƒãƒè‡ªå‹•é©ç”¨

### ã‚¿ã‚¹ã‚¯å®šç¾©

#### Laravelã‚¿ã‚¹ã‚¯å®šç¾©

```json
{
  "family": "asset-management-laravel",
  "networkMode": "awsvpc",
  "requiresCompatibilities": ["FARGATE"],
  "cpu": "1024",
  "memory": "2048",
  "containerDefinitions": [
    {
      "name": "laravel-app",
      "image": "<ECR_REPOSITORY_URL>:latest",
      "portMappings": [
        {
          "containerPort": 8000,
          "protocol": "tcp"
        }
      ],
      "environment": [
        {
          "name": "APP_ENV",
          "value": "production"
        }
      ],
      "secrets": [
        {
          "name": "DB_PASSWORD",
          "valueFrom": "arn:aws:secretsmanager:ap-northeast-1:xxxx:secret:db-password"
        }
      ],
      "logConfiguration": {
        "logDriver": "awslogs",
        "options": {
          "awslogs-group": "/ecs/asset-management-laravel",
          "awslogs-region": "ap-northeast-1",
          "awslogs-stream-prefix": "ecs"
        }
      }
    }
  ]
}
```

**ãƒªã‚½ãƒ¼ã‚¹ä»•æ§˜**:

| é …ç›® | é–‹ç™º | ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚° | æœ¬ç•ª |
|-----|------|------------|------|
| CPU | 512 | 1024 | 1024 |
| ãƒ¡ãƒ¢ãƒª | 1024 MB | 2048 MB | 2048 MB |
| ã‚¿ã‚¹ã‚¯æ•°ï¼ˆæœ€å°ï¼‰ | 1 | 2 | 2 |
| ã‚¿ã‚¹ã‚¯æ•°ï¼ˆæœ€å¤§ï¼‰ | 2 | 4 | 8 |

#### Next.jsã‚¿ã‚¹ã‚¯å®šç¾©

```json
{
  "family": "asset-management-nextjs",
  "networkMode": "awsvpc",
  "requiresCompatibilities": ["FARGATE"],
  "cpu": "512",
  "memory": "1024",
  "containerDefinitions": [
    {
      "name": "nextjs-app",
      "image": "<ECR_REPOSITORY_URL>:latest",
      "portMappings": [
        {
          "containerPort": 3000,
          "protocol": "tcp"
        }
      ],
      "environment": [
        {
          "name": "NEXT_PUBLIC_API_URL",
          "value": "https://api.asset-management.example.com"
        }
      ],
      "logConfiguration": {
        "logDriver": "awslogs",
        "options": {
          "awslogs-group": "/ecs/asset-management-nextjs",
          "awslogs-region": "ap-northeast-1",
          "awslogs-stream-prefix": "ecs"
        }
      }
    }
  ]
}
```

**ãƒªã‚½ãƒ¼ã‚¹ä»•æ§˜**:

| é …ç›® | é–‹ç™º | ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚° | æœ¬ç•ª |
|-----|------|------------|------|
| CPU | 256 | 512 | 512 |
| ãƒ¡ãƒ¢ãƒª | 512 MB | 1024 MB | 1024 MB |
| ã‚¿ã‚¹ã‚¯æ•°ï¼ˆæœ€å°ï¼‰ | 1 | 2 | 2 |
| ã‚¿ã‚¹ã‚¯æ•°ï¼ˆæœ€å¤§ï¼‰ | 2 | 4 | 8 |

### ã‚µãƒ¼ãƒ“ã‚¹æ§‹æˆ

**ECSã‚µãƒ¼ãƒ“ã‚¹ä»•æ§˜**:

| é …ç›® | Laravel | Next.js |
|-----|---------|---------|
| ã‚µãƒ¼ãƒ“ã‚¹å | `laravel-service` | `nextjs-service` |
| èµ·å‹•ã‚¿ã‚¤ãƒ— | Fargate | Fargate |
| ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¿ã‚¤ãƒ— | Rolling Update | Rolling Update |
| æœ€å°ãƒ˜ãƒ«ã‚·ãƒ¼å‰²åˆ | 100% | 100% |
| æœ€å¤§å‰²åˆ | 200% | 200% |
| ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯çŒ¶äºˆæœŸé–“ | 300ç§’ | 180ç§’ |

### ã‚ªãƒ¼ãƒˆã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°

**ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè¿½è·¡ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ãƒãƒªã‚·ãƒ¼**:

| ãƒ¡ãƒˆãƒªã‚¯ã‚¹ | ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå€¤ | ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆ | ã‚¹ã‚±ãƒ¼ãƒ«ã‚¤ãƒ³ |
|----------|-----------|------------|------------|
| CPUä½¿ç”¨ç‡ | 70% | ã‚¿ã‚¹ã‚¯æ•°+1 | ã‚¿ã‚¹ã‚¯æ•°-1 |
| ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡ | 80% | ã‚¿ã‚¹ã‚¯æ•°+1 | ã‚¿ã‚¹ã‚¯æ•°-1 |
| ALBãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•° | 1000/ã‚¿ã‚¹ã‚¯ | ã‚¿ã‚¹ã‚¯æ•°+1 | ã‚¿ã‚¹ã‚¯æ•°-1 |

**ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°è¨­å®š**:
- ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³æœŸé–“: 300ç§’
- ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆ: å³åº§ã«å®Ÿè¡Œ
- ã‚¹ã‚±ãƒ¼ãƒ«ã‚¤ãƒ³: 5åˆ†é–“ãƒ¡ãƒˆãƒªã‚¯ã‚¹ç›£è¦–å¾Œ

## ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹

### RDS PostgreSQLæ§‹æˆ

**RDSã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä»•æ§˜**:

| é …ç›® | å€¤ |
|-----|-----|
| ã‚¨ãƒ³ã‚¸ãƒ³ | PostgreSQL 14.x |
| ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¯ãƒ©ã‚¹ | db.t4g.medium (æœ¬ç•ª), db.t4g.small (ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°) |
| ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚¿ã‚¤ãƒ— | gp3 |
| ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®¹é‡ | 100 GBï¼ˆåˆæœŸï¼‰ã€æœ€å¤§500 GBï¼ˆè‡ªå‹•æ‹¡å¼µï¼‰ |
| IOPS | 3000 |
| ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ | 125 MB/s |
| Multi-AZ | æœ‰åŠ¹ |
| æš—å·åŒ– | æœ‰åŠ¹ (AWS KMS) |

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ—è¨­å®š**:

```
max_connections = 200
shared_buffers = 256MB
effective_cache_size = 1GB
work_mem = 8MB
maintenance_work_mem = 128MB
wal_buffers = 8MB
checkpoint_completion_target = 0.9
random_page_cost = 1.1
effective_io_concurrency = 200
```

### ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æˆ¦ç•¥

**è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**:
- ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä¿æŒæœŸé–“: 7æ—¥é–“
- ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦: 03:00-04:00 JSTï¼ˆæ·±å¤œï¼‰
- ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦: åœŸæ›œæ—¥ 04:00-05:00 JST
- ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ: æ¯æ—¥è‡ªå‹•å–å¾—

**æ‰‹å‹•ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ**:
- æœ¬ç•ªãƒªãƒªãƒ¼ã‚¹å‰: å¿…é ˆ
- å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿å¤‰æ›´å‰: å¿…é ˆ
- ä¿æŒæœŸé–“: 30æ—¥é–“

### ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³

**Multi-AZæ§‹æˆ**:
- ãƒ—ãƒ©ã‚¤ãƒãƒª: ap-northeast-1a
- ã‚¹ã‚¿ãƒ³ãƒã‚¤: ap-northeast-1c
- åŒæœŸãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
- è‡ªå‹•ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ï¼ˆ60-120ç§’ï¼‰

**ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚«ï¼ˆå°†æ¥æ¤œè¨ï¼‰**:
- èª­ã¿å–ã‚Šè² è·ãŒé«˜ã„å ´åˆã«æ¤œè¨
- ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆå°‚ç”¨
- éåŒæœŸãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³

## ã‚­ãƒ£ãƒƒã‚·ãƒ¥

### ElastiCache Redisæ§‹æˆ

**ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ä»•æ§˜**:

| é …ç›® | å€¤ |
|-----|-----|
| ã‚¨ãƒ³ã‚¸ãƒ³ | Redis 7.x |
| ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ— | cache.t4g.small (æœ¬ç•ª), cache.t4g.micro (ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°) |
| ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚°ãƒ«ãƒ¼ãƒ— | æœ‰åŠ¹ |
| ãƒ¬ãƒ—ãƒªã‚«æ•° | 1 |
| Multi-AZ | æœ‰åŠ¹ |
| è‡ªå‹•ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ | æœ‰åŠ¹ |
| æš—å·åŒ– | è»¢é€ä¸­ãƒ»ä¿ç®¡ä¸­ã¨ã‚‚æœ‰åŠ¹ |

**ç”¨é€”åˆ¥ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­è¨ˆ**:

| ç”¨é€” | ã‚­ãƒ¼å½¢å¼ | TTL | èª¬æ˜ |
|-----|---------|-----|------|
| ã‚»ãƒƒã‚·ãƒ§ãƒ³ | `session:{session_id}` | 2æ™‚é–“ | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚»ãƒƒã‚·ãƒ§ãƒ³ |
| APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ | `api:{endpoint}:{params}` | 5åˆ† | APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚­ãƒ£ãƒƒã‚·ãƒ¥ |
| è³‡ç”£æ¤œç´¢ | `search:{query_hash}` | 10åˆ† | æ¤œç´¢çµæœã‚­ãƒ£ãƒƒã‚·ãƒ¥ |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ± | `user:{user_id}` | 1æ™‚é–“ | ãƒ¦ãƒ¼ã‚¶ãƒ¼åŸºæœ¬æƒ…å ± |
| è²¸å‡ºç”³è«‹æ•° | `lending_count:{location}` | 1åˆ† | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é›†è¨ˆ |

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚°ãƒ«ãƒ¼ãƒ—è¨­å®š**:

```
maxmemory-policy: allkeys-lru
timeout: 300
tcp-keepalive: 300
```

## ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸

### S3ãƒã‚±ãƒƒãƒˆæ§‹æˆ

#### è³‡ç”£ç”»åƒãƒ»ãƒ•ã‚¡ã‚¤ãƒ«ãƒã‚±ãƒƒãƒˆ

**ãƒã‚±ãƒƒãƒˆä»•æ§˜**:

| é …ç›® | å€¤ |
|-----|-----|
| ãƒã‚±ãƒƒãƒˆå | `asset-management-files-prod` |
| ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ | ap-northeast-1 |
| ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚° | æœ‰åŠ¹ |
| æš—å·åŒ– | SSE-S3 |
| ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ | ãƒ–ãƒ­ãƒƒã‚¯ï¼ˆç½²åä»˜ãURLä½¿ç”¨ï¼‰ |

**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ **:

```
asset-management-files-prod/
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ images/
â”‚   â”‚   â”œâ”€â”€ {asset_id}/
â”‚   â”‚   â”‚   â”œâ”€â”€ main.jpg
â”‚   â”‚   â”‚   â”œâ”€â”€ sub1.jpg
â”‚   â”‚   â”‚   â””â”€â”€ sub2.jpg
â”‚   â”œâ”€â”€ qr-codes/
â”‚   â”‚   â””â”€â”€ {asset_id}.png
â”‚   â””â”€â”€ manuals/
â”‚       â””â”€â”€ {asset_id}/
â”‚           â””â”€â”€ manual.pdf
â”œâ”€â”€ exports/
â”‚   â””â”€â”€ inventory/
â”‚       â””â”€â”€ {year}/{month}/
â”‚           â””â”€â”€ inventory-{date}.csv
â””â”€â”€ backups/
    â””â”€â”€ {year}/{month}/{day}/
```

#### ãƒ­ã‚°ãƒã‚±ãƒƒãƒˆ

**ãƒã‚±ãƒƒãƒˆä»•æ§˜**:

| é …ç›® | å€¤ |
|-----|-----|
| ãƒã‚±ãƒƒãƒˆå | `asset-management-logs-prod` |
| ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ | ap-northeast-1 |
| ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚° | ç„¡åŠ¹ |
| æš—å·åŒ– | SSE-S3 |
| ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ | ãƒ–ãƒ­ãƒƒã‚¯ |

**ç”¨é€”**:
- ALBã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°
- CloudFrontãƒ­ã‚°
- S3ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°

### ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒãƒªã‚·ãƒ¼

**è³‡ç”£ç”»åƒãƒã‚±ãƒƒãƒˆ**:

| ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚¯ãƒ©ã‚¹ | æœŸé–“ |
|--------------|------|
| Standard | 30æ—¥é–“ |
| Standard-IA | 30-90æ—¥ |
| Glacier | 90æ—¥ä»¥é™ |
| å‰Šé™¤ | 7å¹´å¾Œï¼ˆæ³•çš„è¦ä»¶ï¼‰ |

**ãƒ­ã‚°ãƒã‚±ãƒƒãƒˆ**:

| ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚¯ãƒ©ã‚¹ | æœŸé–“ |
|--------------|------|
| Standard | 7æ—¥é–“ |
| Standard-IA | 7-30æ—¥ |
| Glacier | 30-365æ—¥ |
| å‰Šé™¤ | 1å¹´å¾Œ |

## ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚·ãƒ³ã‚°

### ALBæ§‹æˆ

**Application Load Balancerä»•æ§˜**:

| é …ç›® | å€¤ |
|-----|-----|
| åå‰ | `asset-management-alb` |
| ã‚¹ã‚­ãƒ¼ãƒ  | internet-facing |
| IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚¿ã‚¤ãƒ— | IPv4 |
| ã‚µãƒ–ãƒãƒƒãƒˆ | public-subnet-1a, public-subnet-1c |
| ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ— | alb-sg |
| ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚° | æœ‰åŠ¹ï¼ˆS3ãƒã‚±ãƒƒãƒˆã«ä¿å­˜ï¼‰ |

**ãƒªã‚¹ãƒŠãƒ¼è¨­å®š**:

| ãƒ—ãƒ­ãƒˆã‚³ãƒ« | ãƒãƒ¼ãƒˆ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¢ã‚¯ã‚·ãƒ§ãƒ³ |
|----------|-------|-----------------|
| HTTP | 80 | HTTPSã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ |
| HTTPS | 443 | ãƒ‘ã‚¹ãƒ™ãƒ¼ã‚¹ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚° |

**HTTPSãƒªã‚¹ãƒŠãƒ¼ãƒ«ãƒ¼ãƒ«**:

| å„ªå…ˆåº¦ | æ¡ä»¶ | ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ |
|-------|------|----------|
| 1 | ãƒ‘ã‚¹ `/api/*` | Laravel ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã¸è»¢é€ |
| 2 | ãƒ‘ã‚¹ `/*` | Next.js ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã¸è»¢é€ |

**SSL/TLSè¨¼æ˜æ›¸**:
- AWS Certificate Manager (ACM)ã§ç®¡ç†
- ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰è¨¼æ˜æ›¸: `*.asset-management.example.com`
- è‡ªå‹•æ›´æ–°

### ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—

#### Laravelã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—

| é …ç›® | å€¤ |
|-----|-----|
| åå‰ | `laravel-tg` |
| ãƒ—ãƒ­ãƒˆã‚³ãƒ« | HTTP |
| ãƒãƒ¼ãƒˆ | 8000 |
| ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¿ã‚¤ãƒ— | IP |
| VPC | asset-management-vpc |
| ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ãƒ‘ã‚¹ | `/health` |
| æ­£å¸¸åˆ¤å®šã—ãã„å€¤ | 2 |
| ç•°å¸¸åˆ¤å®šã—ãã„å€¤ | 3 |
| ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ | 5ç§’ |
| é–“éš” | 30ç§’ |
| æˆåŠŸã‚³ãƒ¼ãƒ‰ | 200 |

#### Next.jsã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—

| é …ç›® | å€¤ |
|-----|-----|
| åå‰ | `nextjs-tg` |
| ãƒ—ãƒ­ãƒˆã‚³ãƒ« | HTTP |
| ãƒãƒ¼ãƒˆ | 3000 |
| ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¿ã‚¤ãƒ— | IP |
| VPC | asset-management-vpc |
| ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ãƒ‘ã‚¹ | `/api/health` |
| æ­£å¸¸åˆ¤å®šã—ãã„å€¤ | 2 |
| ç•°å¸¸åˆ¤å®šã—ãã„å€¤ | 3 |
| ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ | 5ç§’ |
| é–“éš” | 30ç§’ |
| æˆåŠŸã‚³ãƒ¼ãƒ‰ | 200 |

### ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯

**Laravelãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ** (`/health`):

```php
// routes/web.php
Route::get('/health', function () {
    // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãƒã‚§ãƒƒã‚¯
    DB::connection()->getPdo();

    // Redisãƒã‚§ãƒƒã‚¯
    Redis::ping();

    return response()->json(['status' => 'healthy'], 200);
});
```

**Next.jsãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ** (`/api/health`):

```typescript
// pages/api/health.ts
export default function handler(req, res) {
  res.status(200).json({ status: 'healthy' });
}
```

## CDN

### CloudFrontæ§‹æˆ

**ãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ä»•æ§˜**:

| é …ç›® | å€¤ |
|-----|-----|
| ã‚ªãƒªã‚¸ãƒ³ | ALB, S3ãƒã‚±ãƒƒãƒˆ |
| ä¾¡æ ¼ã‚¯ãƒ©ã‚¹ | All Edge Locations |
| HTTP/HTTPS | HTTPSã®ã¿ |
| SSLè¨¼æ˜æ›¸ | ACMè¨¼æ˜æ›¸ |
| WAF | æœ‰åŠ¹ |
| ãƒ­ã‚° | æœ‰åŠ¹ï¼ˆS3ãƒã‚±ãƒƒãƒˆï¼‰ |

**ã‚ªãƒªã‚¸ãƒ³è¨­å®š**:

| ã‚ªãƒªã‚¸ãƒ³å | ã‚¿ã‚¤ãƒ— | ç”¨é€” |
|----------|------|------|
| ALB | Custom Origin | å‹•çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ |
| S3 | S3 Origin | é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆç”»åƒç­‰ï¼‰ |

**ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ“ãƒ˜ã‚¤ãƒ“ã‚¢**:

| ãƒ‘ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ | ã‚ªãƒªã‚¸ãƒ³ | TTL | ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒãƒªã‚·ãƒ¼ |
|-----------|---------|-----|---------------|
| `/assets/*` | S3 | 1å¹´ | CachingOptimized |
| `/api/*` | ALB | ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãªã— | - |
| `/*` | ALB | 1æ™‚é–“ | CachingOptimizedForUncompressedObjects |

**åœ°ç†çš„åˆ¶é™**: ãªã—ï¼ˆæ—¥æœ¬å›½å†…åˆ©ç”¨ãŒä¸»ã ãŒã€æµ·å¤–å‡ºå¼µè€…ã‚‚è€ƒæ…®ï¼‰

## DNS

### Route 53æ§‹æˆ

**ãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³**:

| ãƒ‰ãƒ¡ã‚¤ãƒ³ | ã‚¿ã‚¤ãƒ— | èª¬æ˜ |
|---------|------|------|
| `asset-management.example.com` | Public | æœ¬ç•ªç’°å¢ƒ |
| `staging.asset-management.example.com` | Public | ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒ |

**ãƒ¬ã‚³ãƒ¼ãƒ‰è¨­å®š**:

| åå‰ | ã‚¿ã‚¤ãƒ— | å€¤ | ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒãƒªã‚·ãƒ¼ |
|-----|------|-----|-----------------|
| `asset-management.example.com` | A | ALB (Alias) | Simple |
| `www.asset-management.example.com` | CNAME | `asset-management.example.com` | Simple |
| `api.asset-management.example.com` | A | ALB (Alias) | Simple |

**ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯**:
- ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ: `https://asset-management.example.com/api/health`
- é–“éš”: 30ç§’
- å¤±æ•—ã—ãã„å€¤: 3
- CloudWatch Alarmsã¨é€£æº

## ãƒ¡ãƒ¼ãƒ«é€ä¿¡

### SESæ§‹æˆ

**Amazon SESä»•æ§˜**:

| é …ç›® | å€¤ |
|-----|-----|
| ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ | ap-northeast-1 |
| é€ä¿¡ãƒ¢ãƒ¼ãƒ‰ | æœ¬ç•ªãƒ¢ãƒ¼ãƒ‰ |
| é€ä¿¡åˆ¶é™ | 50,000ä»¶/æ—¥ï¼ˆåˆæœŸï¼‰ |
| DKIM | æœ‰åŠ¹ |
| SPF | è¨­å®šæ¸ˆã¿ |

**é€ä¿¡å…ƒã‚¢ãƒ‰ãƒ¬ã‚¹**:
- ã‚·ã‚¹ãƒ†ãƒ é€šçŸ¥: `noreply@asset-management.example.com`
- è²¸å‡ºé€šçŸ¥: `lending@asset-management.example.com`
- æ£šå¸é€šçŸ¥: `inventory@asset-management.example.com`

**ãƒ¡ãƒ¼ãƒ«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ**:

| ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå | ç”¨é€” |
|-------------|------|
| `lending-request` | è²¸å‡ºç”³è«‹é€šçŸ¥ |
| `lending-approval` | è²¸å‡ºæ‰¿èªé€šçŸ¥ |
| `lending-rejection` | è²¸å‡ºå´ä¸‹é€šçŸ¥ |
| `return-reminder` | è¿”å´ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ |
| `inventory-start` | æ£šå¸é–‹å§‹é€šçŸ¥ |

**ãƒã‚¦ãƒ³ã‚¹ãƒ»è‹¦æƒ…å‡¦ç†**:
- SNSãƒˆãƒ”ãƒƒã‚¯ã¨é€£æº
- ãƒã‚¦ãƒ³ã‚¹ç‡ç›£è¦–ï¼ˆ5%è¶…ã§ã‚¢ãƒ©ãƒ¼ãƒˆï¼‰
- è‹¦æƒ…ç‡ç›£è¦–ï¼ˆ0.1%è¶…ã§ã‚¢ãƒ©ãƒ¼ãƒˆï¼‰

## ç›£è¦–ãƒ»ãƒ­ã‚°

### CloudWatch

**ãƒ¡ãƒˆãƒªã‚¯ã‚¹ç›£è¦–**:

| ã‚µãƒ¼ãƒ“ã‚¹ | ãƒ¡ãƒˆãƒªã‚¯ã‚¹ | ã—ãã„å€¤ | ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ |
|---------|----------|---------|----------|
| ALB | TargetResponseTime | 1ç§’ä»¥ä¸Š | SNSé€šçŸ¥ |
| ALB | HTTPCode_Target_5XX_Count | 10ä»¶/5åˆ† | SNSé€šçŸ¥ |
| ECS | CPUUtilization | 80%ä»¥ä¸Š | ã‚ªãƒ¼ãƒˆã‚¹ã‚±ãƒ¼ãƒ« |
| ECS | MemoryUtilization | 80%ä»¥ä¸Š | ã‚ªãƒ¼ãƒˆã‚¹ã‚±ãƒ¼ãƒ« |
| RDS | CPUUtilization | 80%ä»¥ä¸Š | SNSé€šçŸ¥ |
| RDS | FreeableMemory | 256MBä»¥ä¸‹ | SNSé€šçŸ¥ |
| RDS | DatabaseConnections | 180ä»¥ä¸Š | SNSé€šçŸ¥ |
| ElastiCache | CPUUtilization | 75%ä»¥ä¸Š | SNSé€šçŸ¥ |
| ElastiCache | DatabaseMemoryUsagePercentage | 90%ä»¥ä¸Š | SNSé€šçŸ¥ |

**ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹**:

| ãƒ¡ãƒˆãƒªã‚¯ã‚¹å | èª¬æ˜ | åé›†é–“éš” |
|-----------|------|---------|
| `LendingRequestCount` | è²¸å‡ºç”³è«‹æ•° | 1åˆ† |
| `ActiveUsersCount` | ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•° | 5åˆ† |
| `AssetSearchLatency` | è³‡ç”£æ¤œç´¢ãƒ¬ã‚¤ãƒ†ãƒ³ã‚· | 1åˆ† |
| `APIErrorRate` | APIã‚¨ãƒ©ãƒ¼ç‡ | 1åˆ† |

### ãƒ­ã‚°ç®¡ç†

**CloudWatch Logs ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—**:

| ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ— | ä¿æŒæœŸé–“ | èª¬æ˜ |
|-----------|---------|------|
| `/ecs/asset-management-laravel` | 30æ—¥ | Laravelã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚° |
| `/ecs/asset-management-nextjs` | 30æ—¥ | Next.jsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚° |
| `/aws/rds/instance/asset-db/postgresql` | 14æ—¥ | PostgreSQLãƒ­ã‚° |
| `/aws/elasticache/asset-redis` | 7æ—¥ | Redisãƒ­ã‚° |
| `/aws/lambda/asset-batch-jobs` | 30æ—¥ | ãƒãƒƒãƒå‡¦ç†ãƒ­ã‚° |

**ãƒ­ã‚°ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°**:

```
ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°æŠ½å‡ºãƒ•ã‚£ãƒ«ã‚¿: [level = "error" || level = "critical"]
APIé…å»¶ãƒ•ã‚£ãƒ«ã‚¿: [response_time > 1000]
èªè¨¼å¤±æ•—ãƒ•ã‚£ãƒ«ã‚¿: [event = "login_failed"]
```

### ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š

**CloudWatch Alarms â†’ SNS â†’ Slack/Email**:

| ã‚¢ãƒ©ãƒ¼ãƒˆå | æ¡ä»¶ | é‡å¤§åº¦ | é€šçŸ¥å…ˆ |
|----------|------|-------|-------|
| `HighCPUUsage` | ECS CPU > 80% (5åˆ†é–“) | Warning | Slack + Email |
| `DatabaseConnectionFull` | RDSæ¥ç¶šæ•° > 180 | Critical | Slack + Email + é›»è©± |
| `APIErrorRateHigh` | 5XX ã‚¨ãƒ©ãƒ¼ > 10ä»¶/5åˆ† | Critical | Slack + Email |
| `DiskSpaceLow` | RDSç©ºãå®¹é‡ < 10GB | Warning | Slack + Email |
| `HealthCheckFailed` | ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯å¤±æ•— | Critical | Slack + Email + é›»è©± |

**ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**:
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
- é€±æ¬¡/æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•ç”Ÿæˆ
- SLO/SLIè¿½è·¡

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

### IAM

**IAMãƒ­ãƒ¼ãƒ«**:

| ãƒ­ãƒ¼ãƒ«å | ã‚µãƒ¼ãƒ“ã‚¹ | ãƒãƒªã‚·ãƒ¼ |
|---------|---------|---------|
| `ECSTaskExecutionRole` | ECS | ECR, CloudWatch Logs, Secrets Manager |
| `ECSTaskRole` | ECS | S3, RDS, SES, Secrets Manager |
| `LambdaExecutionRole` | Lambda | CloudWatch Logs, S3, RDS |
| `EC2InstanceRole` | EC2 (ãƒãƒƒãƒå‡¦ç†ç”¨) | S3, RDS, CloudWatch |

**æœ€å°æ¨©é™ã®åŸå‰‡**:
- å„ãƒ­ãƒ¼ãƒ«ã«å¿…è¦æœ€å°é™ã®æ¨©é™ã®ã¿ä»˜ä¸
- ãƒªã‚½ãƒ¼ã‚¹ãƒ™ãƒ¼ã‚¹ã®ãƒãƒªã‚·ãƒ¼ã§åˆ¶é™
- ã‚¿ã‚°ãƒ™ãƒ¼ã‚¹ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡

**MFA**:
- AWSã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ã¯å…¨å“¡MFAå¿…é ˆ
- ãƒ«ãƒ¼ãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚¢ã‚¯ã‚»ã‚¹ç¦æ­¢

### Secrets Manager

**ç®¡ç†ã™ã‚‹ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ**:

| ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆå | å†…å®¹ | ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ |
|-------------|------|------------|
| `prod/db/master-password` | RDSãƒã‚¹ã‚¿ãƒ¼ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ | 90æ—¥ |
| `prod/redis/auth-token` | Redisèªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ | 90æ—¥ |
| `prod/jwt/secret-key` | JWTç½²åéµ | 180æ—¥ |
| `prod/ses/smtp-credentials` | SES SMTPèªè¨¼æƒ…å ± | ãªã— |
| `prod/external/ad-credentials` | Active Directoryèªè¨¼æƒ…å ± | 90æ—¥ |

**ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡**:
- ECSã‚¿ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
- å–å¾—ãƒ­ã‚°ã‚’CloudWatch Logsã«è¨˜éŒ²
- ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã§éå»ã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆè¿½è·¡

### WAF

**AWS WAFè¨­å®š**:

| ãƒ«ãƒ¼ãƒ«å | ã‚¿ã‚¤ãƒ— | ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ | èª¬æ˜ |
|---------|------|----------|------|
| `RateLimit` | Rate-based | Block | 5åˆ†é–“ã«1000ãƒªã‚¯ã‚¨ã‚¹ãƒˆè¶… |
| `SQLiProtection` | Managed | Block | SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­– |
| `XSSProtection` | Managed | Block | XSSå¯¾ç­– |
| `IPReputationList` | Managed | Block | æ‚ªæ„ã‚ã‚‹IPãƒ–ãƒ­ãƒƒã‚¯ |
| `KnownBadInputs` | Managed | Block | æ—¢çŸ¥ã®æ”»æ’ƒãƒ‘ã‚¿ãƒ¼ãƒ³ |

**åœ°ç†çš„ãƒ–ãƒ­ãƒƒã‚¯**: ãªã—ï¼ˆæµ·å¤–å‡ºå¼µè€…ã‚’è€ƒæ…®ï¼‰

**ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«**:
- ç®¡ç†ç”»é¢ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã¯ç¤¾å†…IP+VPNã®ã¿è¨±å¯
- APIå‘¼ã³å‡ºã—ãƒ¬ãƒ¼ãƒˆåˆ¶é™ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ï¼‰

## ç¤¾å†…ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶š

### VPNæ¥ç¶š

**AWS Site-to-Site VPN**:

| é …ç›® | å€¤ |
|-----|-----|
| ã‚«ã‚¹ã‚¿ãƒãƒ¼ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ | ç¤¾å†…ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ« |
| ä»®æƒ³ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ | VPCæ¥ç¶š |
| ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚° | é™çš„ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚° |
| ãƒˆãƒ³ãƒãƒ« | å†—é•·æ§‹æˆï¼ˆ2æœ¬ï¼‰ |
| æš—å·åŒ– | IPsec |

**ç¤¾å†…ã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹**:
- RDSã¸ã®ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆé‹ç”¨ãƒ»ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ï¼‰
- ElastiCacheã¸ã®ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆãƒ‡ãƒãƒƒã‚°ï¼‰
- ECS Execã«ã‚ˆã‚‹ã‚³ãƒ³ãƒ†ãƒŠã‚¢ã‚¯ã‚»ã‚¹

### PrivateLink

**AWS PrivateLinkæ§‹æˆ**:

| ã‚µãƒ¼ãƒ“ã‚¹ | ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | ç”¨é€” |
|---------|------------|------|
| S3 | Gateway Endpoint | VPCå†…éƒ¨ã‹ã‚‰S3ã‚¢ã‚¯ã‚»ã‚¹ |
| ECR | Interface Endpoint | ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸å–å¾— |
| Secrets Manager | Interface Endpoint | ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆå–å¾— |
| CloudWatch Logs | Interface Endpoint | ãƒ­ã‚°é€ä¿¡ |

**åˆ©ç‚¹**:
- ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ä¸è¦
- ãƒ‡ãƒ¼ã‚¿è»¢é€ã‚³ã‚¹ãƒˆå‰Šæ¸›
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å‘ä¸Š

## ç½å®³å¾©æ—§

### ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æˆ¦ç•¥

**RDSè‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**:
- ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ: æ¯æ—¥03:00 JST
- ä¿æŒæœŸé–“: 7æ—¥é–“
- ãƒªãƒ¼ã‚¸ãƒ§ãƒ³é–“ã‚³ãƒ”ãƒ¼: é€±æ¬¡ï¼ˆå¤§é˜ªãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã¸ï¼‰

**S3ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**:
- ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°æœ‰åŠ¹
- ã‚¯ãƒ­ã‚¹ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³: å¤§é˜ªãƒªãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆé‡è¦ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ï¼‰
- ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒãƒªã‚·ãƒ¼ã§è‡ªå‹•ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–

**è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**:
- Terraformã‚³ãƒ¼ãƒ‰: GitHubãƒªãƒã‚¸ãƒˆãƒª
- ECSã‚¿ã‚¹ã‚¯å®šç¾©: ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†
- ALBè¨­å®š: AWS Configè¨˜éŒ²

### å¾©æ—§æ‰‹é †

**RDSå¾©æ—§æ‰‹é †**:

1. ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‹ã‚‰æ–°è¦RDSã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆ
2. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—è¨­å®š
3. ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ECSã‚¿ã‚¹ã‚¯å®šç¾©ã«åæ˜ 
4. ECSã‚µãƒ¼ãƒ“ã‚¹æ›´æ–°
5. å‹•ä½œç¢ºèª

**æ¨å®šå¾©æ—§æ™‚é–“**: 30åˆ†

**ECSå¾©æ—§æ‰‹é †**:

1. éå»ã®ã‚¿ã‚¹ã‚¯å®šç¾©ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèª
2. ECSã‚µãƒ¼ãƒ“ã‚¹æ›´æ–°ã§å‰ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯
3. ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ç¢ºèª

**æ¨å®šå¾©æ—§æ™‚é–“**: 5åˆ†

### RTO/RPO

| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | RPOï¼ˆãƒ‡ãƒ¼ã‚¿æå¤±è¨±å®¹æ™‚é–“ï¼‰ | RTOï¼ˆå¾©æ—§ç›®æ¨™æ™‚é–“ï¼‰ |
|-------------|----------------------|-----------------|
| RDS | 5åˆ†ï¼ˆè‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼‰ | 30åˆ† |
| ElastiCache | 1æ™‚é–“ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ãŸã‚ï¼‰ | 10åˆ† |
| S3 | 0åˆ†ï¼ˆè‡ªå‹•ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ | å³åº§ |
| ECSã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ | 0åˆ†ï¼ˆã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ™ãƒ¼ã‚¹ï¼‰ | 5åˆ† |

## ç’°å¢ƒæ§‹æˆ

### é–‹ç™ºç’°å¢ƒ

| é …ç›® | æ§‹æˆ |
|-----|------|
| ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚° | ãƒ­ãƒ¼ã‚«ãƒ«Docker Compose |
| ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ | PostgreSQL (Docker) |
| ã‚­ãƒ£ãƒƒã‚·ãƒ¥ | Redis (Docker) |
| ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ | ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ  |
| ãƒ‰ãƒ¡ã‚¤ãƒ³ | `localhost:3000` |

### ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒ

| é …ç›® | æ§‹æˆ |
|-----|------|
| VPC | `10.1.0.0/16` |
| ECS | æœ€å°2ã‚¿ã‚¹ã‚¯ |
| RDS | db.t4g.small |
| ElastiCache | cache.t4g.micro |
| ãƒ‰ãƒ¡ã‚¤ãƒ³ | `staging.asset-management.example.com` |
| ãƒ‡ãƒ¼ã‚¿ | æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ã®ãƒã‚¹ã‚¯ç‰ˆ |

### æœ¬ç•ªç’°å¢ƒ

| é …ç›® | æ§‹æˆ |
|-----|------|
| VPC | `10.0.0.0/16` |
| ECS | æœ€å°2ã‚¿ã‚¹ã‚¯ã€æœ€å¤§8ã‚¿ã‚¹ã‚¯ |
| RDS | db.t4g.medium (Multi-AZ) |
| ElastiCache | cache.t4g.small (Multi-AZ) |
| ãƒ‰ãƒ¡ã‚¤ãƒ³ | `asset-management.example.com` |

## ã‚³ã‚¹ãƒˆè¦‹ç©ã‚‚ã‚Š

**æœˆé¡ã‚³ã‚¹ãƒˆè¦‹ç©ã‚‚ã‚Šï¼ˆæœ¬ç•ªç’°å¢ƒï¼‰**:

| ã‚µãƒ¼ãƒ“ã‚¹ | ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹/ä»•æ§˜ | æœˆé¡ï¼ˆUSDï¼‰ | æœˆé¡ï¼ˆJPYï¼‰ |
|---------|--------------|-----------|-----------|
| **ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°** |
| ECS Fargate (Laravel) | 2ã‚¿ã‚¹ã‚¯ï¼ˆ1vCPU, 2GBï¼‰ | $60 | Â¥9,000 |
| ECS Fargate (Next.js) | 2ã‚¿ã‚¹ã‚¯ï¼ˆ0.5vCPU, 1GBï¼‰ | $30 | Â¥4,500 |
| **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹** |
| RDS PostgreSQL | db.t4g.medium (Multi-AZ) | $130 | Â¥19,500 |
| ElastiCache Redis | cache.t4g.small (Multi-AZ) | $50 | Â¥7,500 |
| **ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸** |
| S3 | 100GB + ãƒªã‚¯ã‚¨ã‚¹ãƒˆ | $10 | Â¥1,500 |
| RDS ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ | 100GB gp3 | $15 | Â¥2,250 |
| **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯** |
| ALB | 1å° + ãƒ‡ãƒ¼ã‚¿è»¢é€ | $25 | Â¥3,750 |
| NAT Gateway | 2å°ï¼ˆMulti-AZï¼‰ | $65 | Â¥9,750 |
| ãƒ‡ãƒ¼ã‚¿è»¢é€ | 500GB/æœˆ | $45 | Â¥6,750 |
| **ãã®ä»–** |
| CloudWatch | ãƒ­ã‚° + ãƒ¡ãƒˆãƒªã‚¯ã‚¹ | $20 | Â¥3,000 |
| Route 53 | ãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ + ã‚¯ã‚¨ãƒª | $5 | Â¥750 |
| Secrets Manager | 5ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ | $2 | Â¥300 |
| SES | 10,000é€š/æœˆ | $1 | Â¥150 |
| **åˆè¨ˆ** | | **$458** | **Â¥68,700** |

**ã‚³ã‚¹ãƒˆæœ€é©åŒ–ç­–**:
- Savings Plansï¼ˆ1å¹´ã‚³ãƒŸãƒƒãƒˆï¼‰ã§20-30%å‰Šæ¸›
- RDS Reserved Instancesã§40%å‰Šæ¸›
- S3 Intelligent-Tieringã§è‡ªå‹•æœ€é©åŒ–
- CloudWatch Logsã®ä¿æŒæœŸé–“æœ€é©åŒ–

## ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ

### CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

**GitHub Actions ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼**:

```yaml
name: Deploy to Production

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Configure AWS credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: arn:aws:iam::xxxx:role/GitHubActionsRole
          aws-region: ap-northeast-1

      - name: Login to Amazon ECR
        id: login-ecr
        uses: aws-actions/amazon-ecr-login@v1

      - name: Build, tag, and push image to Amazon ECR
        env:
          ECR_REGISTRY: ${{ steps.login-ecr.outputs.registry }}
          ECR_REPOSITORY: asset-management-laravel
          IMAGE_TAG: ${{ github.sha }}
        run: |
          docker build -t $ECR_REGISTRY/$ECR_REPOSITORY:$IMAGE_TAG .
          docker push $ECR_REGISTRY/$ECR_REPOSITORY:$IMAGE_TAG

      - name: Deploy to ECS
        run: |
          aws ecs update-service \
            --cluster asset-management-cluster \
            --service laravel-service \
            --force-new-deployment
```

### Blue/Greenãƒ‡ãƒ—ãƒ­ã‚¤

**ECS Blue/Greenãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †**:

1. **æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¿ã‚¹ã‚¯èµ·å‹•**ï¼ˆGreenï¼‰
2. **ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯å®Ÿæ–½**ï¼ˆGreenï¼‰
3. **ALBã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—åˆ‡ã‚Šæ›¿ãˆ**ï¼ˆBlue â†’ Greenï¼‰
4. **ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ç›£è¦–**ï¼ˆ10åˆ†é–“ï¼‰
5. **æ—§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¿ã‚¹ã‚¯åœæ­¢**ï¼ˆBlueï¼‰

**ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯**:
- ç•°å¸¸æ¤œçŸ¥æ™‚ã¯å³åº§ã«Blueã«åˆ‡ã‚Šæˆ»ã—
- 5åˆ†ä»¥å†…ã«å®Œäº†

## é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](system-architecture.md) - ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
- [æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯](technology-stack.md) - ä½¿ç”¨æŠ€è¡“ã®è©³ç´°
- [ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ](database-design.md) - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ
- [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](security-architecture.md) - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆ
- [ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨­è¨ˆ](performance-design.md) - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
- [../01-requirements/non-functional-requirements.md](../01-requirements/non-functional-requirements.md) - éæ©Ÿèƒ½è¦ä»¶